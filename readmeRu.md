
Автор публикации <h2><a href="https://habr.com/post/416359/">olga0lechk4</a></h2>
6 июля 2018 в 00:19


   <h1 class="post__title post__title_full">
      <span class="post__title-text">Быстрое рабочее окружение для web-разработчиков (Vagrant и PHPStorm)</span>
    </h1>

<h1 >Как быстро создать рабочее окружение для web-разработчиков или настраиваем окружение разработки для работы или изучения HTML, CSS, PHP в Windows.</h1>
      
<p><strong>(статья опубликована на <a href="https://www.linkedin.com/pulse/configure-development-environment-learning-html-css-php-panov/">Linkedin</a>)</strong></p><br>
<p><img src="https://habrastorage.org/getpro/habr/post_images/6e9/c44/f46/6e9c44f46de725be13a0c681ac741c66.jpg" alt="web - developer PHPStorm and Vagrant"></p><br>
<p>Это мой перевод статьи от автора книг по Ассемблеру и Реверсингу программ. Сейчас он в основном публикуется в США. Думаю пригодиться начинающим и не только.</p><br>
<p>Начинающие программисты всегда задаются вопросом, с чего начать изучение создание web-сайтов? Поиск в интернете дает много разнообразной информации, но к сожалению только еще больше запутывает начинающих разработчиков. Имея более чем 5 летний опыт преподавания, я много раз видел, как ученики, делая перерывы в компьютерных играх и решившись стать web-разработчиками, пытались настроить окружения разработки. Они начинали перебирать программы для верстки. Они хватались за Sublime Text, Notepad++, Visual Studio Code, NetBeans или PHPStorm. Пытались ставить себе на локальный компьютер WAMP (расшифровывается как Windows, Apache, MySQL и PHP) платформы, такие как Denver, Xampp, Open Server и многие другие. Но так как в голове начинающего разработчика пока нет систематических знаний, нет опыта настройки, довольно редко у кого из них получалось настроить удобное окружение разработки, а у кого получалось, тот понимал, что играть стало сложнее, так как множество дополнительно установленных программ, мешают наслаждаться плавностью в игре.</p><br>
<p>Данная статья родилась из-за объясняя за многие годы каждому ученику, как все сделать и правильно и удобно.</p><br>
<p>Еще раз хочу сказать, что мы будем настраивать рабочее окружение в системе Windows для изучения создания сайтов на HTML, CSS и их связки с PHP. Будем называть такой компьютер рабочим, чтобы начинающие web-разработчики привыкали к мысли, что их компьютер — это их источник дохода.</p><a name="habracut"></a><br>
<h3 id="nachinaem">Начинаем</h3><br>
<p>Я считаю, что раз вы решили стать web-разработчиком, то самое первое что нужно сделать, это установить на ваш компьютер Git. Git — распределённая система управления версиями. Поверьте мне на слово, что данная система не раз спасет вас, особенно в моменты, когда вы поймете, что что-то получилось плохо. Благодаря git вы сможете четко контролировать когда это случилось и git даст вам возможность откатиться на предыдущую версию редактируемого файла. Удобно ведь, верно?</p><br>
<p>Для установки скачайте и установите Git для Windows (<a href="https://gitforwindows.org/">https://gitforwindows.org/</a>), оставляем все пути и параметры по умолчанию. После установки перезагрузите компьютер. </p><br>
<p>Теперь вы можете использовать Git с помощью командной строки или PowerShell.</p><br>
<p>Я придерживаюсь правила, что устанавливать себе на рабочий компьютер нужно только git и IDE, которая расшифровывается как «интегрированная среда разработки». Все остальное должно работать в серверном варианте. Ставить себе разнообразные WAMP нельзя. Подчеркну, что я говорю именно о WAMP сборках. Я объясню свою точку зрения. WAMP-сборки удобны и хороши, но только тогда, когда вы четко понимаете что и зачем делаете на сервере и сайте. Начинающие просто в силу своего опыта пока этого не могут. Да, читая на многих форумах, где web-разработчики, в том числе и Full Stack Developers, дают советы начинающим, мне очень часто приходилось читать о том, что WAMP-сборки очень удобны. Но по таким советам, можно сразу отличить профессионала, от того, кто только сделал свои первые шаги в сторону web-разработки. Профессионал никогда не посоветует начинающему изучать web-разработку ставить себе WAMP-сборки.</p><br>
<p>А дело тут вот в чем. Окружение в WAMP-сборке довольно сильно отличается от реального окружения, которое есть у web-hosters, на котором и будет находиться ваш готовый сайт. Окружение web-hosters это как правило система на базе UNIX-подобных систем (Linux, CentOS и т.д.), довольно реже это веб-сервер IIS, а при использовании WAMP-сборок у нас получается windows окружение, которое ничего общего с реальным окружением не имеет. На моей практике я был свидетелем, когда WAMP-сборки мешали людям. Например, пришел к нам в команду начинающий web-разработчик, разрабатывающий сайты на домашнем компьютере с WAMP-сборкой. Было у него простое задание сверстать страницу с готового макета и сделать на ней работающую форму обратной связи. Через несколько дней он приносит готовое решение. Мы заливаем его на тестовый сервер, который является точной копией продакшен сервера и видим, что форма не работает, а часть картинок не показывается. Да, опытные разработчики сразу понимают в чем тут дело, но ведь начинающий то этого не понимает и у него паника. Он сразу говорит: «не понимаю, у меня дома все ведь работает». Я прошу его проверить, откуда страница загружает картинки, а так же проверить php-скрипт на наличие абсолютных путей. Когда он это исправляет, все работает. Но это простая форма обратной связи, а если это сайт интернет-магазина, страниц на 400? Или другой пример. Пришлось мне как-то разбираться с развертыванием сайта, который компания заказала у freelance – разработчика. Разработчик сделал на заказ сайт-визитку для одной компании. Когда этот разработчик демонстрировал готовый заказ клиенту на своем рабочем ноутбуке, все работало хорошо, но когда этот сайт перенесли на хостинг провайдера сайт не работал и часть страниц просто не показывалась. Опытные разработчики тоже понимают в чем дело, но начинающим это пока не дано, в силу отсутствия необходимого опыта. Тут дело оказалось в том, что в windows нет поддержки .htaccess, прописав необходимые директивы для работы CMS все заработало. Но это был просто сайт-визитка, а если бы это был интернет магазин с админкой, закрытыми разделами и т.д.? Вот чтобы всего этого избежать, я всем своим ученикам рекомендую использовать если не полное 100%-продакшен окружение, то хотя бы очень близкое к нему, а этого WAMP-сборки обеспечить не могут.</p><br>
<p>У меня две любимые среды, в которых я работаю, это NetBeans and PHPStorm. Кому что больше нравится, решать вам. Я рекомендую поставить обе и попробовать в них поработать. NetBeans бесплатная, PHPStorm стоит $89 для индивидуального разработчика, но есть 30 – дневный триал для того, чтобы вы могли посмотреть на нее в работе.</p><br>
<p>Я расскажу про настройку на примере IDE PHPStorm. Устанавливаем на наш рабочий компьютер IDE PHPStorm, скачав его с <a href="https://www.jetbrains.com">официального сайта</a>. Тут ничего сложного нет, это просто windows-программа, оставляем все пути по умолчанию. Установили.</p><br>
<p>Как я уже говорил, все должно разрабатываться в окружении или идентичном хостеру или очень близко к нему. Для этого нам надо установить на наш компьютер VirtualBox, скачав его с <a href="https://www.virtualbox.org">официального сайта</a>. Тут тоже ничего сложного нет, ставим и перезагружаем компьютер. </p><br>
<h6 id="dalshe-est-dva-puti-razvitiya">Дальше есть два пути развития</h6><br>
<p><u>Первый путь</u>, это создавать вручную внутри VirtualBox виртуальную машину, устанавливать в нее Linux Server, на сервере поднимать Apache, MySQL и PHP. Дальше для отладки нам там же нужно будет установить Xdebug для отладки PHP, попутно разобравшись с зависимостями внутри виртуальной машины и также учесть зависимости с нашей рабочей папкой на хостовой машине. Когда наберешься опыта, это все не так сложно сделать как кажется, но для тех, кто только делает свои первые шаги в сторону WEB-разработки это все не нужные сложности. </p><br>
<p><u>Поэтому есть второй путь</u> развития. Устанавливаем себе на компьютер Vagrant, скачав его с <a href="http://www.vagrantup.com/downloads.html">официального сайта</a>. Vagrant это приложение, которое помогает вам управлять виртуальными машинами. Установили? Если у вас появляется ошибка о несоответствии версии PowerShell, то обновите <a href="https://www.microsoft.com/en-US/download/details.aspx?id=50395">Management Framework</a>. Установили? Отлично. </p><br>
<p>Далее скачиваем архив с vagrant-конфигурацией, которую я подготовил на основе «Ubuntu Server 16.04» и которую предлагаю использовать своим ученикам. Создаем себе рабочую папку, в которой и будем создавать наш сайт. Для примера это будет папка <strong>«webdev»</strong> на диске «С». Как это сделать? Для тех, кто уже установил Git, открываем в проводнике диск «С» и нажимаем правой кнопкой мыши и выбираем <strong>«Git Bash Here»</strong>. </p><br>
<p>&#8203; <img src="https://habrastorage.org/getpro/habr/post_images/0d0/407/469/0d0407469654dc9bd37a908ada97168c.jpg" alt="Panov. Git Bash Here"> </p><br>
<p>Откроется консоль, в которую вводим команду: <strong>git clone <a href="https://github.com/abyss-soft/webdev">https://github.com/abyss-soft/webdev</a></strong> и нажимаем «enter».</p><br>
<p><img src="https://habrastorage.org/getpro/habr/post_images/d32/836/bcb/d32836bcbf3568ef8483336105eea32d.jpg" alt="webdev"></p><br>
<p>После этого у вас на диске появилась наша готовая рабочая папка вот с таким деревом файлов: </p><br>
<p><img src="https://habrastorage.org/getpro/habr/post_images/49c/864/82a/49c86482ac9460b769553f67438c44f1.jpg" alt="webdev tree"></p><br>
<p>Обратите внимание, папка с нашим сайтом, который мы будем разрабатывать, находится вот по этому пути: <strong>C:\webdev\www\webdev.local </strong></p><br>
<p>В дальнейшем, вы сможете заменить в этот папке все файлы на файлы вашего сайта и получив таким образом готовую среду разработки уже вашего сайта.</p><br>
<p>Я также рекомендую вам зарегистрироваться на <a href="https://github.com">https://github.com</a> и сделать “Fork” моего репозитория «<a href="https://github.com/abyss-soft/webdev">https://github.com/abyss-soft/webdev</a>», тем самым вы сохраните его себе и он навсегда останется у вас.</p><br>
<blockquote>Для тех кто не хочет устанавливать себе git, вот прямые ссылки:<br>
<ol>
<li>Прямая ссылка: <a href="https://github.com/abyss-soft/webdev/archive/master.zip">https://github.com/abyss-soft/webdev/archive/master.zip</a> </li>
<li>Ссылка на github: <a href="https://github.com/abyss-soft/webdev">https://github.com/abyss-soft/webdev</a> </li>
<li>Ссылка на Vagrant Box: <a href="https://app.vagrantup.com/alex-panov/boxes/webdev">https://app.vagrantup.com/alex-panov/boxes/webdev</a> </li>
</ol><br>
</blockquote><p>Далее запускаем интерпретатор командной строки, для этого нажимаем Win+R (нажимать так — зажать кнопку с логотипом Windows слева и справа от пробела после альта) и не отпуская её нажать R) и вводим команду «cmd» (без ковычек). В открывшимся окне, мы переходим в нашу созданную папку введя команду <strong>cd c:\webdev</strong>.</p><br>
<p>Перейдя в папку, вводим команду <strong>vagrant up</strong>. Консоль не закрываем. Когда мы поработаем и нам надо будет выключить виртуальный сервер, мы введем команду <strong>vagrant halt</strong>.</p><br>
<p>Первый запуск может занять много времени — будет скачиваться образ, при последующих запусках этого шага не будет, образ будет цепляться из кеша. Далее запустится виртуальная машина. </p><br>
<p>В самой виртуальной машине у нас файл PHP.ini расположенный по адресу <strong>/etc/php/7.0/apache2/php.ini</strong> и имеющий вот такую настройку:</p><br>
<blockquote><em>----------Working:-------</em><br>
<br>
<em>[xdebug]</em><br>
<br>
<em>zend_extension="/usr/lib/php/20151012/xdebug.so"</em><br>
<br>
<em>xdebug.remote_autostart = on</em><br>
<br>
<em>xdebug.remote_enable=on</em><br>
<br>
<em>xdebug.remote_connect_back = on</em><br>
<br>
<em>xdebug.remote_port=9000</em><br>
<br>
<em>xdebug.remote_host=192.168.33.31</em><br>
<br>
<em>xdebug.idekey=PHP_IDE_CONFIG</em></blockquote><p>Где <strong>xdebug.remote_host=192.168.33.31</strong> — это адрес хостового компьютера, в котором у нас запущен PHPStorm.<br>
Дождавшись ее загрузки, пропишем в файле «hosts» (он находится C:\Windows\System32\drivers\etc ) строку: <strong>192.168.33.33 webdev.local</strong></p><br>
<p>Далее запускаем ваш любимый браузер и переходим по ссылке <a href="http://webdev.local">webdev.local</a></p><br>
<p>Если все прошло, как предполагалось, то увидим страницу с текстом <em>«PHP calculating:»</em>, показывающую, что наш тестовый сайт загружен в нашу виртуальную машину на сервере и готов работать. </p><br>
<p><strong>Дальше нам надо подключить к PHPStorm удаленный интерпретатор языка PHP.</strong><br>
Для этого запускаем PHPStorm и создаем новый проект:</p><br>
<p><img src="https://habrastorage.org/getpro/habr/post_images/4cc/d84/cd6/4ccd84cd6dfeaf7c688be90c3437fc5d.jpg" alt="www.panovs.com PHPStorm"></p><br>
<p>Программа подскажет нам, что в данной папке уже существуют файлы и спросит, хотим ли мы создать проект в этой папке:</p><br>
<p><img src="https://habrastorage.org/getpro/habr/post_images/167/b03/e36/167b03e363c7d3e40d730d929f6b7250.jpg" alt="A. Panov"></p><br>
<p>Нажимаем «Yes»</p><br>
<p>Далее нажимаем в меню «File»-&gt; «Settings..»:</p><br>
<p><img src="https://habrastorage.org/getpro/habr/post_images/65a/42a/12a/65a42a12aac50e84f8776f30f8460188.jpg" alt="Panov A."></p><br>
<p>и переходим в секцию <strong>Languages &amp; Frameworks</strong> и в этой секции выберем пункт PHP. В этой секции необходимо назначить интерпретатор для IDE в пункте <strong>CLI Interpreter</strong> нажав на кнопку <strong>[…]</strong></p><br>
<p><img src="https://habrastorage.org/getpro/habr/post_images/b7f/714/b3e/b7f714b3e9d8d3224d1d3419e1a555b8.jpg" alt="PHPStorm"></p><br>
<p>В открывшемся окне, нажимаем на зеленый «+», задаем любое имя, например «Remote PHP 7» и выбираем пункт <strong>Remote…</strong>. </p><br>
<p><img src="https://habrastorage.org/getpro/habr/post_images/dc9/6eb/fe7/dc96ebfe7e443f7f9dd4021d6a18511f.jpg" alt="PHPStorm"></p><br>
<p>В появившимся окне, выбираем <strong>Vagrant</strong> и указываем путь к файлу <strong>«C:\webdev»</strong></p><br>
<p><img src="https://habrastorage.org/getpro/habr/post_images/e55/87e/9f4/e5587e9f47ee95fed6a241c9d1aed198.jpg" alt="webdev - A.Panov"></p><br>
<p>И нажимаем «Ок».</p><br>
<p>Появляется вот такое окно, в котором видны версия PHP и версия отладчика: </p><br>
<p><img src="https://habrastorage.org/getpro/habr/post_images/0a9/60c/6fa/0a960c6fa7f4bdebbfb9908098cb7dd5.jpg" alt="Vagrant and PHPStorm"></p><br>
<p>Далее в секции PHP выберем пункт <strong>Servers (PHP -&gt; Servers)</strong>. Нажимаем на зеленый «+» и вводим любое имя, например «webdev.local» и название хоста: «webdev.local». Номер порта оставляем «80» и отладчик указываем «XDebug». Обязательно включаем галочку <strong>Use path mappings… </strong> указываем соответствие путей:</p><br>
<table>
<thead>
<tr>
<th>File/Directory</th>
<th>Absolute patch on the server</th>
</tr>
</thead>
<tbody>
<tr>
<td>C:\webdev\www\webdev.local</td>
<td>/var/www/webdev.local</td>
</tr>
</tbody>
</table><br>
<p><img src="https://habrastorage.org/getpro/habr/post_images/0ee/402/892/0ee402892e898eff76fdc68c1440efa7.jpg" alt="WebDev"></p><br>
<p>Для более комфортной отладке, а точнее для того, что бы отладчик не всплывал на первой строке любого PHP-файла, нужно отключить данную функцию вот тут:</p><br>
<p><img src="https://habrastorage.org/getpro/habr/post_images/ff7/b75/40c/ff7b7540cb48c9de234182bed3f984fb.jpg" alt="Debug in PHPStorm"></p><br>
<p>Переходим в PHPStorm, в меню "Run" выбираем пункт <strong>Edit Configurations...</strong></p><br>
<p><img src="https://habrastorage.org/getpro/habr/post_images/028/f43/cc6/028f43cc69776ee8284d4c1dfe44d3e7.jpg" alt="PHPStorm A.Panov"></p><br>
<p>В открывшейся форме нажимаем зеленый «+» и выбираем тип приложения <strong>PHP Web Application</strong>. Вводим имя, например «WebApplication», в поле сервер выбираем имя только что созданного нами сервера, стартовый URL и так же можно выбрать браузер, в котором будет открываться сессия xdebug. </p><br>
<p><img src="https://habrastorage.org/getpro/habr/post_images/f92/a7c/189/f92a7c189c1e0d3e1a3e85e96acaf65b.jpg" alt="PHPStorm"></p><br>
<h3 id="vazhno">Важно!</h3><br>
<p>Отладка срабатывает только тогда, когда у PHPStorm включен режим прослушки. Для этого нужно нажать в правом углу <strong>Start Listening for PHP Debug Connections</strong>:</p><br>
<p><img src="https://habrastorage.org/getpro/habr/post_images/72f/8d0/ef0/72f8d0ef0a3a51c0ea6b91809cd4c1da.jpg" alt="Debug in PHPStorm and Vagrant"></p><br>
<p>Также нам нужно установить в браузер дополнительное расширение. Для этого посетим <a href="https://confluence.jetbrains.com/display/PhpStorm/Browser+Debugging+Extensions">официальную страницу JetBrains с Browser Debugging Extensions</a> и скачаем нужное расширение для своего браузера.</p><br>
<p>После того как мы установим наше расширение в браузер, давайте откроем его настройки и укажем <strong>idekey</strong>, который мы уже указали в настройках: <strong><em>PHP_IDE_CONFIG</em></strong></p><br>
<p><img src="https://habrastorage.org/getpro/habr/post_images/00b/869/028/00b869028495348c046b0bf167288867.jpg"></p><br>
<p>В PHPStorm активируем слушатель (в правом углу <strong>Start Listening for PHP Debug Connections</strong>) и жмём на <strong>Run WebApplication</strong>. Отладка на уровне PHPStorm запущена.</p><br>
<p>Далее мы активируем Debug Extension. Для этого заходим на адрес нашего сайта <a href="http://webdev.local">http://webdev.local</a> и после того как зашли нажимаем на значок жучка (уже в браузере) и выбираем пункт <strong>Debug</strong> в «Google Chrome»</p><br>
<p><img src="https://habrastorage.org/getpro/habr/post_images/909/ac4/3b3/909ac43b3323dfce3e0fcc7df6684b1b.jpg" alt="Run WebApplication"></p><br>
<p>Или в «Mozilla Firefox»</p><br>
<p><img src="https://habrastorage.org/getpro/habr/post_images/1c3/d8e/2ef/1c3d8e2ef4517e021bd0bad43062d833.jpg" alt="PHPStorm"></p><br>
<p>После чего значок станет зелёным. </p><br>
<p>После данных настроек можно спокойно ставить брекпоинты и отлаживать ваши PHP-сайты. После того, как в PHPStorm мы установим брекпоин, нужно в боаузере обновить страницу, и увидеть, что она повисла в режиме загрузки, а в PHPStorm сработали брекпоинты.</p><br>
<p>Например поставим брекпоинт на строке </p><br>
<blockquote>$x = 2;</blockquote><p>И нажмем «Run WebApplication»:</p><br>
<p><img src="https://habrastorage.org/getpro/habr/post_images/16b/fb2/e7a/16bfb2e7ad815b83e0dcd43f304a5e44.jpg" alt="Run WebApplication"> </p><br>
<p>Как видим, наш отладчик остановился на нашем брекпоинте и показывает нам Variables (переменные):</p><br>
<p><img src="https://habrastorage.org/getpro/habr/post_images/fa4/db7/7c2/fa4db77c2a9a5cc1a3e8e6f6a958b291.jpg" alt="Debug in PHPStorm"> </p><br>
<p>Если мы понажимаем клавишу <strong>F8</strong>, то увидим, что отладчик перемещается пошагово, показывая все наши переменные:</p><br>
<p>Вот таким способом, мы установили и настроили наше рабочее окружение, в котором можем полноценно работать.</p></div>

  </div>
